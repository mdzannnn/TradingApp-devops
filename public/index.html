<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeJournal Pro 2026</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- 
      =========================================
      STYLESHEET (CSS)
      =========================================
    -->
    <style>
        :root {
            --bg-main: #0b0f1a; 
            --bg-card: #161b2c; 
            --bg-hover: #1f2937;
            --text-main: #f8fafc; 
            --text-muted: #94a3b8;
            --primary: #6366f1; 
            --primary-hover: #4f46e5;
            --profit: #10b981; 
            --profit-bg: rgba(16, 185, 129, 0.1);
            --loss: #f43f5e; 
            --loss-bg: rgba(244, 63, 94, 0.1);
            --border: #2d3748;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg-main); color: var(--text-main); min-height: 100vh; padding: 20px; padding-bottom: 80px; }
        .container { max-width: 1200px; margin: 0 auto; width: 100%; }

        /* Header */
        .header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 20px; border-bottom: 1px solid var(--border); margin-bottom: 30px; }
        .logo { font-size: 1.6rem; font-weight: 800; display: flex; align-items: center; gap: 12px; }
        .logo i { color: var(--primary); }
        .live-status { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; font-weight: 600; color: var(--profit); text-transform: uppercase; }
        .dot { width: 8px; height: 8px; background-color: var(--profit); border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: var(--bg-card); padding: 24px; border-radius: 20px; border: 1px solid var(--border); box-shadow: 0 4px 20px rgba(0,0,0,0.2); }
        .stat-label { color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; }
        .stat-value { font-size: 2.2rem; font-weight: 800; margin-top: 8px; }

        /* Dashboard Layout */
        .dashboard-grid { display: grid; grid-template-columns: 350px 1fr; gap: 24px; }
        @media (max-width: 950px) { .dashboard-grid { grid-template-columns: 1fr; } }

        .card { background: var(--bg-card); padding: 24px; border-radius: 20px; border: 1px solid var(--border); margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 12px; }
        .card-title { font-size: 1rem; font-weight: 700; display: flex; align-items: center; gap: 10px; }

        /* Calendar Styles */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
        .weekday { text-align: center; color: var(--text-muted); font-size: 0.75rem; font-weight: 800; padding-bottom: 10px; }
        .day { aspect-ratio: 1; background: var(--bg-main); border-radius: 10px; padding: 6px; border: 1px solid transparent; cursor: pointer; display: flex; flex-direction: column; transition: 0.2s; }
        .day:hover { border-color: var(--primary); transform: scale(1.03); z-index: 5; background: var(--bg-hover); }
        .day.today { border: 1.5px solid var(--primary); }
        .day-num { font-size: 0.75rem; font-weight: 800; color: var(--text-muted); }
        .pnl-tag { font-size: 0.65rem; font-weight: 900; margin-top: auto; text-align: center; padding: 2px; border-radius: 4px; }
        .win { color: var(--profit); background: var(--profit-bg); }
        .loss { color: var(--loss); background: var(--loss-bg); }

        /* Forms */
        .form-group { margin-bottom: 15px; }
        label { display: block; color: var(--text-muted); margin-bottom: 8px; font-size: 0.8rem; font-weight: 700; }
        input, select { width: 100%; background: var(--bg-main); border: 1px solid var(--border); color: var(--text-main); padding: 14px; border-radius: 12px; font-size: 0.95rem; outline: none; }
        .btn { width: 100%; padding: 14px; border-radius: 12px; font-weight: 700; cursor: pointer; border: none; transition: 0.2s; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 100; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .modal.active { display: flex; }
        .modal-content { background: var(--bg-card); padding: 32px; border-radius: 24px; width: 90%; max-width: 420px; border: 1px solid var(--border); box-shadow: 0 10px 40px rgba(0,0,0,0.5); }

        /* Ticker */
        .footer-ticker { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--bg-card); border-top: 1px solid var(--border); padding: 12px 0; color: var(--text-muted); font-family: monospace; font-weight: 700; font-size: 0.85rem; }
        
        .recent-item { display: flex; justify-content: space-between; padding: 12px; border-radius: 10px; background: rgba(255,255,255,0.02); margin-bottom: 8px; font-size: 0.8rem; }
        .price-up { color: var(--profit); }
        .price-down { color: var(--loss); }
    </style>
</head>
<body>

<div class="container">
    <header class="header">
        <div class="logo"><i class="fa-solid fa-chart-line"></i> TradeJournal 2026</div>
        <div class="live-status"><div class="dot"></div>API Connected</div>
    </header>

    <!-- TOP STATS -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Net Performance (SGD)</div>
            <div class="stat-value" id="total-pnl">$0.00</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Win Rate</div>
            <div class="stat-value" id="win-rate">0%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">System Status</div>
            <div class="stat-value text-profit" style="font-size: 1.2rem; padding-top: 10px;">ACTIVE</div>
        </div>
    </div>

    <div class="dashboard-grid">
        <!-- LEFT TOOLS -->
        <div class="left-section">
            <div class="card">
                <div class="card-header"><div class="card-title"><i class="fa-solid fa-calculator"></i> Currency Converter</div></div>
                <div class="form-group">
                    <label>Base Amount</label>
                    <input type="number" id="qc-amount" placeholder="e.g. 100">
                </div>
                <div class="form-group" style="display:flex; gap:8px;">
                    <select id="qc-from" class="fiat-dropdown"></select>
                    <select id="qc-to" class="fiat-dropdown"></select>
                </div>
                <button class="btn btn-primary" onclick="runQuickConvert()">Calculate Exchange</button>
                <div id="qc-result" style="margin-top:20px; text-align:center; font-size: 1.4rem; font-weight: 900; color: var(--profit);"></div>
            </div>

            <div class="card">
                <div class="card-header"><div class="card-title"><i class="fa-solid fa-history"></i> Recent Activity</div></div>
                <div id="recent-list" style="max-height: 300px; overflow-y: auto;">
                    <!-- Activity items -->
                </div>
            </div>
        </div>

        <!-- MAIN CALENDAR -->
        <div class="main-section">
            <div class="card">
                <div class="card-header">
                    <div class="card-title"><i class="fa-solid fa-calendar-day"></i> Trading Journal 2026</div>
                    <div style="display:flex; gap:12px; align-items:center;">
                        <button class="btn" style="width:32px; height:32px; background:var(--bg-hover); color:white; padding:0;" onclick="changeMonth(-1)"><i class="fa-solid fa-angle-left"></i></button>
                        <span id="current-month" style="font-weight: 800; width:140px; text-align:center; color: var(--primary);">...</span>
                        <button class="btn" style="width:32px; height:32px; background:var(--bg-hover); color:white; padding:0;" onclick="changeMonth(1)"><i class="fa-solid fa-angle-right"></i></button>
                    </div>
                </div>
                <div class="calendar-grid">
                    <div class="weekday">SUN</div><div class="weekday">MON</div><div class="weekday">TUE</div><div class="weekday">WED</div><div class="weekday">THU</div><div class="weekday">FRI</div><div class="weekday">SAT</div>
                </div>
                <div class="calendar-grid" id="calendar-days"></div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL -->
<div class="modal" id="entry-modal">
    <div class="modal-content">
        <h3 style="margin-bottom:20px;"><i class="fa-solid fa-pen-nib"></i> Log Journal Entry</h3>
        <form id="trade-form">
            <input type="date" id="trade-date" readonly style="margin-bottom:12px; background: var(--bg-hover); border: none;">
            <div class="form-group">
                <label>Asset/Currency</label>
                <select id="asset-choice" class="fiat-dropdown"></select>
            </div>
            <div class="form-group">
                <label>P&L Amount (Units)</label>
                <input type="number" id="pnl-amount" placeholder="e.g. 500 or -200" step="any" required>
            </div>
            <div style="display:flex; gap:10px;">
                <button type="submit" class="btn btn-primary">Save Trade</button>
                <button type="button" class="btn" style="background:var(--bg-hover); color:white; width:100%; border-radius:12px;" onclick="closeModal()">Cancel</button>
            </div>
        </form>
    </div>
</div>

<div class="footer-ticker"><marquee id="master-ticker">Syncing market exchange rates for 2026 terminal...</marquee></div>

<!-- 
  =========================================
  LOGIC (JAVASCRIPT)
  =========================================
-->
<script>
    const FIAT_CURRENCIES = [
        { code: "USD", name: "US Dollar" }, { code: "SGD", name: "SG Dollar" },
        { code: "EUR", name: "Euro" }, { code: "GBP", name: "British Pound" },
        { code: "JPY", name: "Japanese Yen" }, { code: "MYR", name: "Malaysian Ringgit" },
        { code: "AUD", name: "Australian Dollar" }, { code: "CAD", name: "Canadian Dollar" },
        { code: "CHF", name: "Swiss Franc" }, { code: "HKD", name: "Hong Kong Dollar" },
        { code: "BTC", name: "Bitcoin" }, { code: "ETH", name: "Ethereum" }
    ];

    const API_URL = 'https://open.er-api.com/v6/latest/USD';
    let currentRates = {};
    let trades = JSON.parse(localStorage.getItem('trade_journal_2026')) || [];
    let viewDate = new Date(2026, new Date().getMonth(), 1);

    document.addEventListener('DOMContentLoaded', async () => {
        setupDropdowns();
        await syncMarkets();
        renderCalendar();
        updateStats();
        // Refresh rates every minute
        setInterval(syncMarkets, 60000);
    });

    function setupDropdowns() {
        const selects = document.querySelectorAll('.fiat-dropdown');
        selects.forEach(s => {
            FIAT_CURRENCIES.forEach(c => {
                const opt = document.createElement('option');
                opt.value = c.code;
                opt.textContent = `${c.code} - ${c.name}`;
                // Default settings
                if(s.id === 'qc-to' && c.code === 'SGD') opt.selected = true;
                if(s.id === 'asset-choice' && c.code === 'USD') opt.selected = true;
                s.appendChild(opt);
            });
        });
    }

    async function syncMarkets() {
        try {
            const res = await fetch(API_URL);
            const data = await res.json();
            currentRates = data.rates;
            
            let ticker = "MARKET RATES :: ";
            ['SGD', 'EUR', 'GBP', 'JPY', 'MYR'].forEach(c => {
                ticker += `${c}: ${currentRates[c].toFixed(3)} | `;
            });
            document.getElementById('master-ticker').innerText = ticker;
            updateStats();
        } catch (e) { console.error("API Sync Failed", e); }
    }

    function runQuickConvert() {
        const amt = parseFloat(document.getElementById('qc-amount').value);
        const from = document.getElementById('qc-from').value;
        const to = document.getElementById('qc-to').value;
        if(isNaN(amt) || !currentRates[from]) return;
        
        const res = (amt / currentRates[from]) * currentRates[to];
        document.getElementById('qc-result').innerText = `${to} ${res.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
    }

    function changeMonth(step) {
        const next = new Date(viewDate.getFullYear(), viewDate.getMonth() + step, 1);
        if(next.getFullYear() !== 2026) return;
        viewDate = next;
        renderCalendar();
    }

    function renderCalendar() {
        const grid = document.getElementById('calendar-days');
        grid.innerHTML = '';
        const y = viewDate.getFullYear();
        const m = viewDate.getMonth();
        
        document.getElementById('current-month').innerText = viewDate.toLocaleString('default', { month: 'long', year: 'numeric' });
        
        const firstDay = new Date(y, m, 1).getDay();
        const daysInMonth = new Date(y, m+1, 0).getDate();

        for(let i=0; i<firstDay; i++) grid.appendChild(document.createElement('div'));

        for(let i=1; i<=daysInMonth; i++) {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'day';
            const dStr = `${y}-${String(m+1).padStart(2,'0')}-${String(i).padStart(2,'0')}`;
            const dayTrades = trades.filter(t => t.date === dStr);
            
            dayDiv.innerHTML = `<span class="day-num">${i}</span>`;
            if(dayTrades.length > 0) {
                const sgdVal = dayTrades.reduce((acc, t) => acc + ((t.amt / currentRates[t.cur]) * currentRates['SGD']), 0);
                const tag = document.createElement('div');
                tag.className = `pnl-tag ${sgdVal >= 0 ? 'win' : 'loss'}`;
                tag.innerText = `$${Math.abs(sgdVal).toFixed(0)}`;
                dayDiv.appendChild(tag);
            }
            
            const now = new Date();
            if(y === now.getFullYear() && m === now.getMonth() && i === now.getDate()) dayDiv.classList.add('today');
            
            dayDiv.onclick = () => openModal(dStr);
            grid.appendChild(dayDiv);
        }
    }

    const modal = document.getElementById('entry-modal');
    function openModal(d) { modal.classList.add('active'); document.getElementById('trade-date').value = d; }
    function closeModal() { modal.classList.remove('active'); }

    document.getElementById('trade-form').addEventListener('submit', (e) => {
        e.preventDefault();
        trades.push({
            date: document.getElementById('trade-date').value,
            cur: document.getElementById('asset-choice').value,
            amt: parseFloat(document.getElementById('pnl-amount').value),
            id: Date.now()
        });
        localStorage.setItem('trade_journal_2026', JSON.stringify(trades));
        closeModal(); renderCalendar(); updateStats();
    });

    function updateStats() {
        let total = 0, wins = 0;
        const recent = document.getElementById('recent-list');
        recent.innerHTML = '';
        
        trades.sort((a,b) => b.id - a.id).forEach(t => {
            if(!currentRates[t.cur]) return;
            const sgd = (t.amt / currentRates[t.cur]) * currentRates['SGD'];
            total += sgd;
            if(sgd > 0) wins++;
            
            const item = document.createElement('div');
            item.className = 'recent-item';
            item.innerHTML = `
                <div><strong>${t.date}</strong><br><small>${t.amt} ${t.cur}</small></div>
                <div class="${sgd >= 0 ? 'price-up' : 'price-down'}">$${sgd.toFixed(2)}</div>
            `;
            recent.appendChild(item);
        });
        
        document.getElementById('total-pnl').innerText = `$${total.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        document.getElementById('total-pnl').className = `stat-value ${total >= 0 ? 'text-profit' : 'text-loss'}`;
        document.getElementById('win-rate').innerText = trades.length ? Math.round((wins/trades.length)*100) + '%' : '0%';
    }
</script>
</body>
</html>
